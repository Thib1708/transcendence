{% extends 'base.html' %}

{% block css %}
{% load static %}
<link rel="stylesheet" href="{% static 'pong_app/css/style.css' %}">
{% endblock %}

{% block title %}
{{ user.username }} profile
{% endblock %}

{% block content %}

<img src={{ user.photo.url }} alt="profile picture" width="100" height="100">
<p>{{ user.username }}</p>

{% if user.id == request.user.id %}

	<p>{{ user.email}}</p>

	<form method="POST" enctype="multipart/form-data" novalidate>
		{% csrf_token %}

		<h2>Edit informations</h2>

	<h4>Change username</h4>
		{{form.username}}

	<h4>Change profile picture</h4>
	{{form.photo}}

	</br>
		
		{% for message in messages %}
			<div>
				{% if message.tags == 'success' %}
					<a data-dismiss="alert">✅</a>
				{% else %}
					<a data-dismiss="alert">⚠️</a>
				{% endif %}
				{{ message }}
			</div>
		{% endfor %}
		
		<input type="submit" value="Accept modifications"/>
	</form>

{% else %}

	</br>

	{% if user.id in request.user.blockedUsers %}
	<a href="#" data-route="{% url 'unblock' user.id %}" onclick="navigateTo(event, this.dataset.route)">
		<button>Unblock</button>
	</a>
	{% else %}
	<a href="#" data-route="{% url 'block' user.id %}" onclick="navigateTo(event, this.dataset.route)">
		<button>Block</button>
	</a>
	{% endif %}


	{% if user.id in request.user.blockedUsers %}
		<p>You can't send a chat or follow this user</p>

	{% else %}
		{% if user.id in request.user.follows %}
			<a href="#" data-route="{% url 'unfollow' user.id %}" onclick="navigateTo(event, this.dataset.route)">
				<button>Unfollow</button>
			</a>
		{% else %}
			<a href="#" data-route="{% url 'follow' user.id %}" onclick="navigateTo(event, this.dataset.route)">
				<button>Follow</button>
			</a>
		{% endif %}

		{% if room %}
			<a href="#" data-route="{% url 'room' room %}" onclick="navigateTo(event, this.dataset.route)">
				<button>Send a chat</button>
			</a>
		{% else %}
			<a href="#" data-route="{% url 'create_channel' ids %}" onclick="navigateTo(event, this.dataset.route)">
				<button>Send a chat</button>
			</a>
		{% endif%}
	{% endif %}

{% endif %}

{% endblock %}